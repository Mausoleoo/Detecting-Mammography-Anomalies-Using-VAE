# Description
A Variational Autoencoder was used to detect anomalies in breast mammographies. Trained on healthy breast images, with ELBO as the loss function and a latent space of 1024, the model identifies anomalies when the reconstruction error exceeds the average. It also generates realistic images of healthy breasts.

---------------------------------------------------------------------------------------------------------------------------------------------
# Libraries

Torch 2.4.1

Pandas 2.1.3

Numpy 1.26.2

Matplotlib 3.8.3


---------------------------------------------------------------------------------------------------------------------------------------------
# Dataset

The VinDr-Mammo dataset was used, containing images from 5,000 patients, with 4 images per patient, totaling 20,000 images. Each patient has 2 views for both breasts. The dataset's accompanying CSV file, Metadata.csv, was slightly modified to suit the specific needs of the project.

The dataset was previously preprocessed by SSMan and downloaded from

https://www.kaggle.com/datasets/ssmann/vindr-mammo-dataset

---------------------------------------------------------------------------------------------------------------------------------------------
# Model

The VAE model is stored in the VAE.py file and utilizes convolutional layers. The encoder consists of 4 convolutional layers, employing ReLU activation and max pooling. Fully connected layers are used for the latent space representation. The decoder is made up of 4 deconvolution layers, producing an output that matches the input size. The VAEConv function takes the input size, number of channels, and initial channels, which allows for larger feature maps in the convolutional layers.


---------------------------------------------------------------------------------------------------------------------------------------------
# Training 

Due to computational limitations, a sample of 1,000 images was used for training, consisting exclusively of images with no findings (healthy). The model was trained for 450 epochs, with all images resized to 128x128 to ensure consistency and optimize processing efficiency.

The model showed a consistent decrease in loss throughout training, and it appeared that the loss would continue to improve with further training. However, I was unable to continue due to time constraints and the cost associated with using Google Colab Pro for extended training sessions.

![image](https://github.com/user-attachments/assets/672a3d2a-5609-45d8-9f4b-bd287a1e1c0e)

Here are some images generated by adding random numbers to the latent space and using only the decoder. While the images donâ€™t yet have a clear or well-formed structure, further training of the model may lead to improved image quality and more realistic outputs.

![image](https://github.com/user-attachments/assets/27a8ae55-d46d-4181-8eb6-07281fca56c3)

---------------------------------------------------------------------------------------------------------------------------------------------
# Test

The main goal of this project is to detect anomalies in breast mammographies by analyzing the reconstruction error in the loss function. The model has been trained exclusively on healthy images, meaning that when it encounters a breast with an anomaly, the reconstruction error is likely to be higher, as the model struggles to accurately recreate features it has not learned to recognize.

To analyze the model's performance, 20 healthy images from the test set of the VinDr-Mammo dataset were randomly selected and passed through the model to examine the reconstruction error. The same process was applied to 20 images with anomalies, allowing for a comparison of how the model handles both healthy and anomalous mammographies.

The results from the healthy images are as follows

![image](https://github.com/user-attachments/assets/e9218e20-09da-4fbc-9930-573cb48222c8)

The results from the images with findings are as follows

![image](https://github.com/user-attachments/assets/4a3e98fb-3ebd-4326-b6b3-08159edb6b73)

